<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rate Villain - Hall of Hate</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #ffffff;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .header p {
            color: #bdc3c7;
            font-size: 1.1rem;
        }

        .navigation {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 40px;
        }

        .nav-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .rate-form {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .villain-display {
            text-align: center;
            margin-bottom: 40px;
        }

        .villain-image {
            width: 120px;
            height: 120px;
            border-radius: 15px;
            object-fit: cover;
            border: 3px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .villain-info h2 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 10px;
        }

        .villain-info p {
            color: #bdc3c7;
            font-size: 1rem;
        }

        .current-score {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 10px;
        }

        .rating-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .rating-section h3 {
            font-size: 1.3rem;
            color: #ffffff;
            margin-bottom: 20px;
        }

        .slider-container {
            margin-bottom: 30px;
        }

        .slider-wrapper {
            position: relative;
            margin: 0 auto;
            max-width: 400px;
        }

        .hate-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(135deg, #2ecc71, #f39c12, #e67e22, #e74c3c, #8e44ad);
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            margin: 20px 0;
        }

        .hate-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ffffff;
            border: 3px solid #e74c3c;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .hate-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ffffff;
            border: 3px solid #e74c3c;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .slider-track {
            display: none;
        }

        .slider-fill {
            display: none;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #bdc3c7;
        }

        .slider-label-current {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1.2rem;
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 60px;
            text-align: center;
        }

        .rating-description {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 30px;
        }

        .rating-description h4 {
            color: #3498db;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rating-description p {
            color: #bdc3c7;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: #ffffff;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .hate-levels {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
            font-size: 0.8rem;
        }

        .hate-level {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #bdc3c7;
        }

        .hate-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .level-1-20 { background-color: #2ecc71; }
        .level-21-40 { background-color: #f39c12; }
        .level-41-60 { background-color: #e67e22; }
        .level-61-80 { background-color: #e74c3c; }
        .level-81-99 { background-color: #8e44ad; }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .rate-form {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .slider-wrapper {
                max-width: 300px;
            }

            .slider-label-current {
                font-size: 1rem;
                padding: 6px 12px;
                min-width: 50px;
            }

            .slider-labels {
                font-size: 0.8rem;
            }

            .form-actions {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .hate-levels {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Rate Villain</h1>
            <p>Hall of Hate - Cast Your Vote</p>
        </div>

        <div class="navigation">
            <a href="/hall-of-hate" class="nav-btn">‚Üê Back to Hall of Hate</a>
        </div>

        <div class="rate-form">
            <div class="villain-display">
                <img src="{{ request.url_for('static', path='hall_of_hate/' + villain.image_filename) }}" 
                     alt="{{ villain.name }}"
                     class="villain-image"
                     onerror="this.src='{{ request.url_for('static', path='hall_of_hate/default.png') }}'">
                <div class="villain-info">
                    <h2>{{ villain.name }}</h2>
                    <p>Rate this villain's hate level</p>
                    <div class="current-score">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26 12,2"/>
                        </svg>
                        Current Score: {{ villain.hate_score }}/10
                    </div>
                </div>
            </div>

            <form method="POST" id="rating-form" action="/hall-of-hate/{{ villain.id }}/rate">
                <div class="rating-section">
                    <h3>How much do you hate this villain?</h3>
                    
                    <div class="slider-container">
                        <div class="slider-wrapper">
                            <div class="slider-track">
                                <div class="slider-fill" id="slider-fill"></div>
                            </div>
                            <input type="range" 
                                   id="hate-slider" 
                                   name="hate_rating" 
                                   min="1" 
                                   max="99" 
                                   value="{{ villain.user_rating }}" 
                                   class="hate-slider"
                                   required>
                            <div class="slider-labels">
                                <span class="slider-label-min">1</span>
                                <span class="slider-label-current" id="current-value">{{ villain.user_rating }}</span>
                                <span class="slider-label-max">99</span>
                            </div>
                        </div>
                    </div>

                    <div class="rating-description" id="rating-description">
                        <h4 id="rating-title">{{ villain.user_rating }}/99 - Loading...</h4>
                        <p id="rating-text">Initializing rating description...</p>
                    </div>
                </div>

                <div class="hate-levels">
                    <div class="hate-level">
                        <div class="hate-indicator level-1-20"></div>
                        <span>1-20: Mild Dislike</span>
                    </div>
                    <div class="hate-level">
                        <div class="hate-indicator level-21-40"></div>
                        <span>21-40: Annoying</span>
                    </div>
                    <div class="hate-level">
                        <div class="hate-indicator level-41-60"></div>
                        <span>41-60: Genuine Hate</span>
                    </div>
                    <div class="hate-level">
                        <div class="hate-indicator level-61-80"></div>
                        <span>61-80: Deep Hatred</span>
                    </div>
                    <div class="hate-level">
                        <div class="hate-indicator level-81-99"></div>
                        <span>81-99: Pure Rage</span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="submit-btn" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26 12,2"/>
                        </svg>
                        Submit Rating
                    </button>
                    <a href="/hall-of-hate" class="btn btn-secondary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M18 6L6 18"/>
                            <path d="M6 6l12 12"/>
                        </svg>
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script>
        function getRatingDescription(rating) {
            if (rating <= 5) return { title: "Barely Annoying", text: "This person is mildly irritating but mostly harmless." };
            if (rating <= 10) return { title: "Slight Dislike", text: "You find them a bit annoying but can tolerate them." };
            if (rating <= 15) return { title: "Mildly Irritating", text: "They're starting to get on your nerves." };
            if (rating <= 20) return { title: "Noticeable Annoyance", text: "You're beginning to actively notice their flaws." };
            if (rating <= 25) return { title: "Moderately Annoying", text: "They get on your nerves more often than not." };
            if (rating <= 30) return { title: "Growing Dislike", text: "Your patience with them is wearing thin." };
            if (rating <= 35) return { title: "Quite Annoying", text: "You actively try to avoid interactions with them." };
            if (rating <= 40) return { title: "Strong Dislike", text: "Their behavior consistently bothers you." };
            if (rating <= 45) return { title: "Genuinely Disliked", text: "You have a real problem with this person's behavior." };
            if (rating <= 50) return { title: "Genuine Hatred", text: "You really can't stand this person." };
            if (rating <= 55) return { title: "Strong Hatred", text: "Their presence makes you genuinely angry." };
            if (rating <= 60) return { title: "Intense Dislike", text: "Everything about them irritates you." };
            if (rating <= 65) return { title: "Deep Hatred", text: "You can't stand anything about this person." };
            if (rating <= 70) return { title: "Serious Loathing", text: "They represent many things you despise." };
            if (rating <= 75) return { title: "Intense Loathing", text: "Just thinking about them ruins your mood." };
            if (rating <= 80) return { title: "Extreme Hatred", text: "This person embodies everything you hate." };
            if (rating <= 85) return { title: "Pure Rage", text: "This person represents everything you despise." };
            if (rating <= 90) return { title: "Maximum Hatred", text: "The absolute worst. No redeeming qualities whatsoever." };
            if (rating <= 95) return { title: "Legendary Hatred", text: "Your hatred for them is the stuff of legends." };
            return { title: "ULTIMATE RAGE", text: "The pinnacle of human hatred. This person is the worst of the worst." };
        }

        // Handle slider changes
        const slider = document.getElementById('hate-slider');
        const currentValue = document.getElementById('current-value');
        const titleElement = document.getElementById('rating-title');
        const textElement = document.getElementById('rating-text');
        const submitBtn = document.getElementById('submit-btn');

        function updateSlider() {
            const rating = parseInt(slider.value);
            
            console.log('Slider value:', rating);
            
            // Update visual elements
            currentValue.textContent = rating;
            
            // Update description
            const description = getRatingDescription(rating);
            titleElement.textContent = `${rating}/99 - ${description.title}`;
            textElement.textContent = description.text;
            
            // Enable submit button
            submitBtn.disabled = false;
        }

        // Add multiple event listeners to ensure slider works
        slider.addEventListener('input', function(e) {
            console.log('Input event triggered, value:', e.target.value);
            updateSlider();
        });
        
        slider.addEventListener('change', function(e) {
            console.log('Change event triggered, value:', e.target.value);
            updateSlider();
        });
        
        slider.addEventListener('mousedown', function(e) {
            console.log('Mouse down on slider');
        });

        // Initialize with default value
        console.log('Initializing slider with value:', slider.value);
        updateSlider();
        
        // Ensure slider is functional
        console.log('Slider element:', slider);
        console.log('Slider min:', slider.min, 'max:', slider.max, 'value:', slider.value);

        // Form submission handling
        document.getElementById('rating-form').addEventListener('submit', function(e) {
            const rating = slider.value;
            if (!rating || rating < 1 || rating > 99) {
                e.preventDefault();
                alert('Please select a valid hate rating between 1 and 99.');
                return;
            }

            // Add loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = `
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="m16 12-4-4-4 4"/>
                    <path d="m12 16 0-8"/>
                </svg>
                Submitting Rating: ${rating}/99...
            `;
        });
    </script>
</body>
</html>